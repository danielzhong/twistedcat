#!/usr/bin/env python

from twisted.internet.endpoints import clientFromString, serverFromString
from twisted.internet import reactor

from twistedcat import EndpointServerProxy

import argparse
import sys



# twistedcat - twisted endpoint concatenator

def main():

    servers = None
    clients = None
    num_servers = 0

    parser = argparse.ArgumentParser(description='twistedcat - proxy between any two Twisted endpoints')
    parser.add_argument("-c", "--client", help="Twisted client endpoint descriptor string")
    parser.add_argument("-s", "--server", help="Twisted server endpoint descriptor string")
    args = parser.parse_args()

    server_endpoint = serverFromString(reactor, args.server)
    client_endpoint = clientFromString(reactor, args.client)

    endpoint_pipe = EndpointServerProxy(client_endpoint, server_endpoint)
    endpoint_pipe.start()
    reactor.run()


if __name__ == '__main__':
    main()
